"use strict";class Selectd{constructor(e){this.settings=Object.assign({selector:".selectd",debug:!1},e),this.cs=document.querySelectorAll(this.settings.selector),this.csLength=this.cs.length,this.currSelectElem=null,this.itemSelected=null,this.optionsList=null,this.optionItem=null,this.init(),document.addEventListener("click",this.closeAllSelect)}init(){for(let e=0;e<this.csLength;e++){this.currSelectElem=this.cs[e].getElementsByTagName("select")[0],this.currSelectElem.disabled&&this.cs[e].classList.add("selectd--disabled");const t=this.currSelectElem.length;this.itemSelected=document.createElement("DIV"),this.itemSelected.setAttribute("class","selectd-container"),-1!=this.currSelectElem.selectedIndex?this.itemSelected.innerHTML=this.currSelectElem.options[this.currSelectElem.selectedIndex].innerHTML:this.itemSelected.innerHTML=this.currSelectElem.options[0].innerHTML,this.cs[e].appendChild(this.itemSelected),this.optionsList=document.createElement("DIV"),this.optionsList.setAttribute("class","selectd-items selectd-items--hide");let s=[];for(let e=1;e<t;e++)this.optionItem=document.createElement("DIV"),this.optionItem.setAttribute("class","selectd-items__item"),this.optionItem.innerHTML=this.currSelectElem.options[e].innerHTML,this.currSelectElem.options[e].disabled&&this.optionItem.classList.add("selectd-items__item--disabled"),this.currSelectElem.options[e].hidden&&this.optionItem.classList.add("selectd-items__item--hidden"),this.optionItem.addEventListener("click",e=>{let t=e.target,i=t.parentNode.parentNode.getElementsByTagName("select")[0],l=i.length,c=t.parentNode.previousSibling;for(let e=0;e<l;e++)if(i.options[e].innerHTML==t.innerHTML){if(i.multiple)1==i.options[e].selected?(i.options[e].selected=!1,s=s.filter(e=>e!=t.innerHTML),t.classList.remove("selectd-items__item--active"),this.traceClick("rm",i,t.innerHTML,s)):(i.options[e].selected=!0,s.push(t.innerHTML),t.classList.add("selectd-items__item--active"),this.traceClick("add",i,t.innerHTML,s)),c.innerHTML=s.join(", ");else{i.selectedIndex=e,c.innerHTML=t.innerHTML,s[0]=t.innerHTML;const l=t.parentNode.getElementsByClassName("selectd-items__item--active"),n=l.length;for(let e=0;e<n;e++)l[e].classList.remove("selectd-items__item--active");t.classList.add("selectd-items__item--active"),this.traceClick("add",i,t.innerHTML,s)}break}c.click()}),this.optionsList.appendChild(this.optionItem);this.cs[e].appendChild(this.optionsList),this.itemSelected.addEventListener("click",e=>{e.stopPropagation(),this.closeAllSelect(e.target),e.target.nextSibling.classList.toggle("selectd-items--hide"),e.target.classList.toggle("selectd-container--active")})}}closeAllSelect(e){let t=[];const s=document.getElementsByClassName("selectd-items"),i=document.getElementsByClassName("selectd-container"),l=s.length,c=i.length;for(let s=0;s<c;s++)e==i[s]?t.push(s):i[s].classList.remove("selectd-container--active");for(let e=0;e<l;e++)t.indexOf(e)&&s[e].classList.add("selectd-items--hide")}traceClick(e,t,s,i){this.settings.debug&&(console.log(""),console.log(" --- "),console.log(t),console.log(e,s," => ",i),console.log(" --- "),console.log(""))}}